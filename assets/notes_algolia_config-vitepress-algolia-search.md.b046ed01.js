import{_ as s,o as a,c as n,Q as l}from"./chunks/framework.af5d88b3.js";const F=JSON.parse('{"title":"配置 Vitepress 的 Algolia 搜索","description":"","frontmatter":{},"headers":[],"relativePath":"notes/algolia/config-vitepress-algolia-search.md","filePath":"notes/algolia/config-vitepress-algolia-search.md","lastUpdated":1671616492000}'),o={name:"notes/algolia/config-vitepress-algolia-search.md"},p=l(`<h1 id="配置-vitepress-的-algolia-搜索" tabindex="-1">配置 Vitepress 的 Algolia 搜索 <a class="header-anchor" href="#配置-vitepress-的-algolia-搜索" aria-label="Permalink to &quot;配置 Vitepress 的 Algolia 搜索&quot;">​</a></h1><p><a href="https://docsearch.algolia.com/docs/legacy/run-your-own/" target="_blank" rel="noreferrer">Doc</a></p><h2 id="前置条件" tabindex="-1">前置条件 <a class="header-anchor" href="#前置条件" aria-label="Permalink to &quot;前置条件&quot;">​</a></h2><ul><li>注册 <code>algolia</code> 的账号</li><li><code>intel</code> 或者 <code>amd</code> 的 <code>x86-64</code> 处理器 (<code>Apple</code> 的 <code>M1</code> 试过了不行)</li><li><a href="https://stedolan.github.io/jq/" target="_blank" rel="noreferrer">jq</a> 是一个 轻量级 和 灵活 的命令行 <code>JSON</code> 工具<div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">brew</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">jq</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;"># 如果你有安装 homebrew</span></span>
<span class="line"><span style="color:#6A737D;"># or 使用 yum 来安装 jq</span></span>
<span class="line"><span style="color:#6A737D;"># 1. yum install epel-release -y</span></span>
<span class="line"><span style="color:#6A737D;"># 2. yum update -y</span></span>
<span class="line"><span style="color:#6A737D;"># 3. yum install jq -y</span></span>
<span class="line"><span style="color:#6A737D;"># 4. jq -V 检查是否安装成功</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">brew</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">jq</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 如果你有安装 homebrew</span></span>
<span class="line"><span style="color:#6A737D;"># or 使用 yum 来安装 jq</span></span>
<span class="line"><span style="color:#6A737D;"># 1. yum install epel-release -y</span></span>
<span class="line"><span style="color:#6A737D;"># 2. yum update -y</span></span>
<span class="line"><span style="color:#6A737D;"># 3. yum install jq -y</span></span>
<span class="line"><span style="color:#6A737D;"># 4. jq -V 检查是否安装成功</span></span></code></pre></div></li><li><a href="https://www.docker.com/" target="_blank" rel="noreferrer">docker</a></li></ul><h2 id="配置" tabindex="-1">配置 <a class="header-anchor" href="#配置" aria-label="Permalink to &quot;配置&quot;">​</a></h2><ul><li><p><code>.env</code></p><p><code>/root/algolia/.env</code></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># Algolia 应用程序的 ID</span></span>
<span class="line"><span style="color:#E1E4E8;">APPLICATION_ID</span><span style="color:#F97583;">=</span></span>
<span class="line"><span style="color:#6A737D;"># 有读有写的能力的 Admin Api Key</span></span>
<span class="line"><span style="color:#E1E4E8;">API_KEY</span><span style="color:#F97583;">=</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># Algolia 应用程序的 ID</span></span>
<span class="line"><span style="color:#24292E;">APPLICATION_ID</span><span style="color:#D73A49;">=</span></span>
<span class="line"><span style="color:#6A737D;"># 有读有写的能力的 Admin Api Key</span></span>
<span class="line"><span style="color:#24292E;">API_KEY</span><span style="color:#D73A49;">=</span></span></code></pre></div></li><li><p><code>config.json</code></p><p><code>/root/algolia/config.json</code></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">&quot;index_name&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;你的 algolia 的 index 名，随便起&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">&quot;start_urls&quot;</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;https://需要爬虫的 blog 网页地址.com&quot;</span><span style="color:#E1E4E8;">],</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">&quot;selectors&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;lvl0&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;lvl1&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;.content h1&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;lvl2&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;.content h2&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;lvl3&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;.content h3&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;lvl4&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;.content h4&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;lvl5&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;.content h5&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;content&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;.content p, .content li&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">&quot;index_name&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;你的 algolia 的 index 名，随便起&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">&quot;start_urls&quot;</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;https://需要爬虫的 blog 网页地址.com&quot;</span><span style="color:#24292E;">],</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">&quot;selectors&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;lvl0&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;lvl1&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;.content h1&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;lvl2&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;.content h2&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;lvl3&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;.content h3&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;lvl4&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;.content h4&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;lvl5&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;.content h5&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;content&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;.content p, .content li&quot;</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div></li></ul><h2 id="运行" tabindex="-1">运行 <a class="header-anchor" href="#运行" aria-label="Permalink to &quot;运行&quot;">​</a></h2><p>使用 <code>docker</code> 进行爬虫</p><ul><li>解释 <ul><li><code>--env-file=/root/algolia/.env</code> 读取 <code>ID</code> 和 <code>Key</code></li><li><code>-e &quot;CONFIG=$(xxx)&quot;</code> 把解析的 <code>json</code> 配置放到 <code>CONFIG</code> 这个环境变量里 <ul><li><code>$(cat /root/algolia/config.json | jq -r tostring)</code> 用 <code>jq</code> 解析 (把 <code>json</code> 变成一行)</li></ul></li></ul></li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">run</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-it</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--env-file=/root/algolia/.env</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-e</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;CONFIG=$(</span><span style="color:#B392F0;">cat</span><span style="color:#9ECBFF;"> /root/algolia/config.json </span><span style="color:#F97583;">|</span><span style="color:#9ECBFF;"> </span><span style="color:#B392F0;">jq</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">-r</span><span style="color:#9ECBFF;"> tostring)&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">algolia/docsearch-scraper</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">run</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-it</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--env-file=/root/algolia/.env</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-e</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;CONFIG=$(</span><span style="color:#6F42C1;">cat</span><span style="color:#032F62;"> /root/algolia/config.json </span><span style="color:#D73A49;">|</span><span style="color:#032F62;"> </span><span style="color:#6F42C1;">jq</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">-r</span><span style="color:#032F62;"> tostring)&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">algolia/docsearch-scraper</span></span></code></pre></div><h2 id="vitepress" tabindex="-1">vitepress <a class="header-anchor" href="#vitepress" aria-label="Permalink to &quot;vitepress&quot;">​</a></h2><p><code>.vitepress/config.js</code></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { defineConfig } </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;vitepress&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">default</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">defineConfig</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">  themeConfig: {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// ...</span></span>
<span class="line"><span style="color:#E1E4E8;">    algolia: {</span></span>
<span class="line"><span style="color:#E1E4E8;">      appId: </span><span style="color:#9ECBFF;">&#39;Algolia 应用程序的 ID，随便起&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      apiKey: </span><span style="color:#9ECBFF;">&#39;只有读能力的 Api Key&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      indexName: </span><span style="color:#9ECBFF;">&#39;你的 algolia 的 index 名&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    },</span></span>
<span class="line"><span style="color:#E1E4E8;">  },</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { defineConfig } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;vitepress&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">default</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">defineConfig</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">  themeConfig: {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// ...</span></span>
<span class="line"><span style="color:#24292E;">    algolia: {</span></span>
<span class="line"><span style="color:#24292E;">      appId: </span><span style="color:#032F62;">&#39;Algolia 应用程序的 ID，随便起&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      apiKey: </span><span style="color:#032F62;">&#39;只有读能力的 Api Key&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      indexName: </span><span style="color:#032F62;">&#39;你的 algolia 的 index 名&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre></div>`,13),e=[p];function t(c,r,i,y,E,d){return a(),n("div",null,e)}const q=s(o,[["render",t]]);export{F as __pageData,q as default};
